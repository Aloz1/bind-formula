# An example pillar file, written by Alastair Knowles

bind:

### Overrides for the defaults specified by defaults.sls and map.jinja ###
#  lookup:
#    pkgs:
#      - bind9
#      - bind9utils
#
#    service_name: bind9

### General config options ###
  config:
    options:

      ip-v4-port: 53
      ip-v6-port: 53

      listen-ip-v4:
        - any

      listen-ip-v6:
        - none


### Defining a key file ###
  keys:
    core_dhcp:
      algorithm: 'hmac-sha256'
      secret: 'a_secret_generated_by_dnssec-keygen'                             # Replace the text here with the secret generated by dnssec-keygen or ddns-confgen

### Defining zone files ###
  zones:
    '.':                    # Root
      type: forward         # This will be a forwarding zone
      forwarders:
        - 192.158.1.2       # We are forwarding all requests to this other dns server

    example.com:       # Our first authoritive zone
      type: master          # We are the master of this zone
      notify: False         # Can't be bothered notifing other servers of changes

      allow-update:         # Lets allow all updates from the given places
        - key "core_dhcp"   # Anyone with this key

      # Note: This option is mutually exclusive the above option in bind,
      #       thus the above will be excluded if an update-policy line is
      #       defined.
      update-policy:
        - grant core_dhcp zonesub ANY

      # Some settings for our zone file (this modifies our SOA record)
      authority:
        ttl: 1h
        email: root@examplemail.com
        refresh: 1200
        retry: 600
        expiry: 120
        nxttl: 600

      # And lets add some static records as well
      records:
        salt:
          type: CNAME
          opts:
            - salt-master # Only 1 opt for CNAME type records
          

    1.168.192.in-addr.arpa:            # A reverse lookup for the above zone
      type: master                     # Again, we are the master
      notify: False                    # And we're still too lazy to notify slaves

      authority:
        ttl: 1h
        email: root@examplemail.com
        refresh: 1200
        retry: 600
        expiry: 120
        nxttl: 600
